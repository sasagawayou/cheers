CREATE TABLE account (id BIGINT AUTO_INCREMENT, user_name VARCHAR(20) DEFAULT '' NOT NULL, show_name VARCHAR(20) DEFAULT '' NOT NULL, password VARCHAR(20) DEFAULT '' NOT NULL, address VARCHAR(200), email VARCHAR(100), twitter BIGINT, mixi BIGINT, facebook BIGINT, google BIGINT, last_login DATETIME, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE page (id BIGINT AUTO_INCREMENT, title VARCHAR(100) DEFAULT '' NOT NULL, body LONGTEXT DEFAULT '' NOT NULL, category VARCHAR(32) DEFAULT '' NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, slug VARCHAR(255), UNIQUE INDEX page_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE user (id INT AUTO_INCREMENT COMMENT 'ID', name VARCHAR(255) DEFAULT 'no name' NOT NULL COMMENT 'ユーザー名', image LONGBLOB COMMENT 'アイコン画像', address VARCHAR(200), email VARCHAR(100), twitter BIGINT, mixi BIGINT, facebook BIGINT, google BIGINT, last_login DATETIME, hybridauth_provider_name VARCHAR(20) NOT NULL COMMENT 'HybridAuthプロバイダ', hybridauth_provider_uid VARCHAR(255) NOT NULL COMMENT 'HybridAuthプロバイダUID', created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) COMMENT = 'ユーザー' DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = MyISAM;
CREATE TABLE vote_comment (id BIGINT AUTO_INCREMENT, ita_id BIGINT DEFAULT 0 NOT NULL, comment VARCHAR(255) DEFAULT NULL, user VARCHAR(65) DEFAULT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX ita_id_idx (ita_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE vote_ita (id BIGINT AUTO_INCREMENT, title VARCHAR(100) NOT NULL, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE vote_shop (id BIGINT AUTO_INCREMENT, ita_id BIGINT DEFAULT 0 NOT NULL, url VARCHAR(255) DEFAULT NULL, name VARCHAR(255) DEFAULT NULL, address VARCHAR(255) DEFAULT NULL, votes BIGINT DEFAULT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX ita_id_idx (ita_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
ALTER TABLE vote_comment ADD CONSTRAINT vote_comment_ita_id_vote_ita_id FOREIGN KEY (ita_id) REFERENCES vote_ita(id) ON DELETE CASCADE;
ALTER TABLE vote_shop ADD CONSTRAINT vote_shop_ita_id_vote_ita_id FOREIGN KEY (ita_id) REFERENCES vote_ita(id) ON DELETE CASCADE;
